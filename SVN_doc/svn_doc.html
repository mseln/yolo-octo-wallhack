<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>TDDD63 SVN intro</title>

	<style>
	body {
		margin:25px;
		margin-left: 100px;
		margin-right: 100px;
		padding:25px;
		background-color:#FFEBD6;
	}
	div.top{
		margin-top: 0px;
		margin-bottom: 5px;
		
		padding-left: 10px;
		padding-right: 10px;
		
		border: solid 2px black;
		background-color:#FFCC99;
	}
	div.note { 
		padding:.8em 1em .8em; 
		margin: 1em 0; 
		border:1px 
		solid #FF9933;
		padding-left:65px;
		background:url("note.png") .8em .8em no-repeat;
		background-color:#FFCC99;
	}
	.note-title {
		color: #487858;
		font-weight: bold;
		margin-bottom: 0 !important;
		margin-top: 0 !important;
	}
	div.code {
		padding:.8em 1em .8em; 
		margin: 1em 0; 
		border:1px 
		solid #471932;
		background-color:#2C001E;
		
		font-family: Consolas, monospace;
		font-size:10pt;
		color:#FFFFFF;
	}
	
	</style>
</head>

<body>
	<div id="main">
		<div class="top">
			<h1>TDDD63 SVN intro</h1>		
		</div>

		<h2>Kort om versionshantering</h2>
		<h3>Vad är versionshantering?</h3>
		<p>
			Versionshantering är ett sätt att spara ändringshistorik för ett projekt, d.v.s. hur de filer som projektet är uppbyggt av förändrats med tiden. Det gör det möjligt att gå tillbaka till en tidigare version av en fil.
		</p>
		<p>
			Det underlättar dessutom arbetet då flera arbetar på samma projekt, då filerna synkas mellan de som jobbar på projektet i princip automatiskt. De flesta versionshanteringssystem, inklusive SVN som ni kommer att använda i denna kurs, fungerar som så att när man jobbat färdigt för dagen eller känner att man klarat av ett delmoment uppdaterar man <i>repot</i> med den kod man nyss skrivit. När nästa person sedan ska arbeta med projektet så börjar den med att ladda ned de senaste uppdateringarna, från <i>repot</i>, som gjorts sedan man senast laddade ned dem.  Principiellt kan man se det som att det finns en server som håller reda på den aktuella koden för projektet.  En användare kan när som helst uppdatera sin lokala kopia av koden till den senaste versionen som finns på servern eller uppdatera koden på servern till den senaste versionen av användarens lokala kod.
		</p>
		<p>
			En mer grundläggande visuell introduktion till versionshantering hittar ni <a href="http://betterexplained.com/articles/a-visual-guide-to-version-control/">här</a>.
		</p>

		<h3>Varför är versionshantering bra?</h3>
		<p>Det finns flera anledningar att använda ett versionshanteringssystem. Nedan följer några exempel.</p>
		<ul>
			<li>För att hålla koll på olika versioner av sitt projekt.</li>
			<li>För att göra det smidigt att arbeta flera på samma projekt.</li>
			<li>För fler exempel, se till exempel diskussion på <a href="http://stackoverflow.com/questions/1408450/why-should-i-use-version-control">stack overflow</a>.</li>
		</ul>

		<h3>Vad är Subversion (SVN)? </h3>
		<p>
			<a href="http://subversion.tigris.org/">Subversion (SVN)</a> är det versionhanteringsystem som används av IDA, d.v.s. det som ni kommer att använda er av i kursen. Det är ett open source-projekt och väldigt utbrett bland open source-användare. Exempel på grupper som använder det är Apache, Google Code och Source Forge. (Läs mer om SVN på  <a href="http://en.wikipedia.org/wiki/Apache_Subversion">wikipedia</a>).
		</p>

		<h2>Kort intro till hur man använder SVN.</h2>
		<h3>Komma igång!</h3>
		<h4>Kolla om svn är installerat</h4>
		<p>
			För att kunna använda SVN måste du ha lagt till modulen för SVN. Kontrollera dock först om du redan har SVN-modulen installerad, genom att ge följande kommando i ett terminalfönster:
		</p>
		<code>svn help</code>
		<p>
			Om svaret är "svn: Command not found" måste du lägga till SVN-modulen. Antingen kan du i varje terminalfönster där du vill använda SVN ge kommandot
		</p>
		<code>module add prog/subversion</code>
		<p>
			eller så kan du ge följande kommando i något terminalfönster
		</p>
		<code>module initadd prog/subversion</code>
		<p>
			och logga ut.  Därefter kommer SVN att automatiskt vara tillgängligt i alla terminalfönster du öppnar.
		</p>
		<div class="note">
			<p class="note-title">Kör egen dator?</p>
			<p>Om du använder dig av en egen dator, kan du installera SVN med:</p>
			<code>sudo apt-get install subversion</code>
			<p>om du kör ubuntu eller debian d.v.s. För installation på andra system, se <a href="http://subversion.apache.org/packages.html">http://subversion.apache.org/</a></p>
		</div>
		
		<h4>Hämta ett repo</h4>
		<p>
			När SVN väl är installerat, måste du hämta ett repo. Du behöver inte oroa dig för hur man sätter upp ett repo, eftersom ni kommer få tillgång till ett färdigkonfigurerat.
		</p>
		
		<p>
			Om du vill delta i ett projekt som använder sig av subversion måste du först hämta hem repot till din egen dator, så att du kan hålla dig uppdaterad med vad andra gör och ladda upp ditt eget arbete. Detta kallas att "checka ut", och det gör du genom att köra kommandot <code>svn checkout &lt;path to repo&gt; &lt;where you want to store the repo&gt;</code>
		</p>
		<div class="code">
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn checkout file:///home/stalinpard/svnrep/example_project/trunk /home/stalinpard/Desktop/svn_ex/ <br>
			<font color="#999999">
				Checked out revision 10.
			</font>
		</div>
		<p>
			Kör du detta kommando kommer en mapp, i sökvägen du angav, att skapas och allt som repot innehåller kommer läggas till i denna mapp.
		</p>
		<p>
			Notera att sökvägen är <code>file:///home/stalinpard/svnrep/example_project/trunk</code>, d.v.s en filsökväg, det är eftersom ett lokalt repo används. Om du ska använda ett repo som ligger på en webbserver så använder du en URL istället.
		</p>
		<p>
			Repositories skapas på formen:
		</p>
		<p><code>
			svn-und.ida.liu.se/courses/TDDC69/2012-1-LABBAR_OCH_PROJEKT/grupp_a-10
		</code></p>
		<p>
			där "a" är vad gruppen döpts till i WebReg och 10 är ett
			löpnummer.  Det går alltså att få t.ex.
		</p>
		<p><code>
			svn-und.ida.liu.se/courses/TDDD73/2013-1-LABBAR/grupp_d1a-XX <br>
			svn-und.ida.liu.se/courses/TDDC69/2013-1-PROJEKT/grupp_humanoids-XX
		</code></p>
		<p>
			För att kontrollera länken, ge följande kommando:
		</p>
		<p>
			<code>
		   		svn list https://svn-und.ida.liu.se/courses/TDDC69/2012-1-LABBAR_OCH_PROJEKT/grupp_a-10
		   	</code>
		<p>
			Nu är du igång! Bara att börja jobba med repot, lägga till filer, modifiera filer, ta bort filer, ladda upp arbete, ta ned andras arbete...
		</p>

		<div class="note">
			<p class="note-title">Jag vill testa att göra mitt egna repo</p>
			<p>
				Är du mer intressad av SVN, kanske för att göra ett repo för eget bruk. I så fall kan man antingen göra ett lokalt repo, som bara finns på datorn eller ett som alla med Internetuppkoppling kan nå.
			</p>
			<ul>
				<li><a href="http://www.guyrutenberg.com/2007/10/29/creating-local-svn-repository-home-repository/">Instruktioner för att sätta upp ett lokalt repo</a> (ganska lätt)</li>
				<li><a href="http://queens.db.toronto.edu/~nilesh/linux/subversion-howto/">Instruktioner för att sätta upp ett globalt repo</a> (krångligare)</li>
			</ul>
		</div>

		<h3>Hur gör jag för att...</h3>
		<h4>Lägga till en fil</h4>
		<p>
			Filer du skapar i mappen där repot ligger kommer inte automatiskt att bli versionshanterade, utan du måste säga till svn att den ska ta hand om de nya filerna. Gör detta med kommandot <code>svn add &lt;file&gt;</code>. Om du kör <code>svn update</code> kommer den att visa ett <code>?</code> om du inte har lagt till den och när du har lagt till den kommer den att visa ett <code>A</code>, som betyder "added". Denna fil kommer att läggas till i repot nästa gång du gör en commit.
		</p>
		<div class="code">
			stalinpard@stalinpard:~/Desktop/svn_ex$ touch b.txt <br>
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn status <br>
			<font color="#999999">
				?       b.txt <br>
			</font>
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn add b.txt <br> 
			<font color="#999999">
				A         b.txt <br>
			</font>
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn status <br>
			<font color="#999999">
				A       b.txt
			</font>
		</div>

		<h4>Ta bort en fil</h4>
		<p>
			På samma sätt som att lägga till en fil, så kommer inte svn att ta bort en versionshanterad fil om du bara tar bort den lokalt. Säg till SVN att filen inte längre finns genom att köra <code>svn rm &lt;fil&gt;</code>. Om du kör detta kommando, kommer fil att tas bort från repot vid nästa "commit". Notera att om du kör <code>svn rm &lt;fil&gt;</code> kommer filen även att tas bort från den lokala mappen, d.v.s. från din dator. Om du kör svn update kommer den att visa ett ! om du inte har sagt till svn att filen är borta, för att svn inte kan hitta filen, och när du har lagt till den kommer den att visa ett D, som står för "deleted".
		</p>
		<div class="code">
			stalinpard@stalinpard:~/Desktop/svn_ex$ rm b.txt <br>
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn status <br>
			<font color="#999999">
				!       b.txt <br>
			</font>
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn rm b.txt <br>
			<font color="#999999">			
				D         b.txt <br>
			</font>
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn status <br>
			<font color="#999999">
				D       b.txt
			</font>
		</div>

		<h4>Hämta det som min arbetskamrat laddat upp</h4>
		<p>
			Kör kommandot <code>svn update</code>, då kommer allt arbete som gjorts på repot sedan din senaste update att laddas ned till din dator.
		</p>
		<div class="code">
			stalinpard@stalinpard:~/Desktop/svn_fx$ svn update<br>
			<font color="#999999">
				U    a.txt<br>
				Updated to revision 10.
			</font>
		</div>

		<h4>Ladda upp det arbete jag har gjort till repot</h4>

		<p>
			Kör kommandot <code>svn commit -m '&lt;ditt meddelande&gt;'</code>
		</p>

		<p>Exempel: Ändrat filen a.txt.</p>
		<div class="code">
			stalinpard@stalinpard:~/Desktop/svn_ex$ vim a.txt <br>
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn status <br>
			<font color="#999999">
				M       a.txt <br>
			</font>
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn commit -m 'modified a.txt' <br>
			<font color="#999999">
				Sending        a.txt <br>
				Transmitting file data . <br>
				Committed revision 13.
			</font>
		</div>
		<p>Exempel: Tagit bort filen b.txt</p>
		<div class="code">
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn commit -m 'removed b.txt'<br>
			<font color="#999999">
				Deleting       b.txt<br>
				<br>
				Committed revision 10.
			</font>
		</div>

		<div class="note">
			<p class="note-title">Vad ska jag göra om jag råkar ladda upp något felaktigt</p>
			<p>
				Försök inte att återställa den senaste "commiten" utan åtgärda felet och gör en ny "commit". En bra ide kan ju vara att skicka med meddelande om att man råkade göra ett fel som nu är åtgärdat.
			</p>
		</div>

		<div class="note">
			<p class="note-title">ÅNEJ! jag glömde <code>update</code> och får en conflict när jag ska göra en commit.</p>
			<p>
				Nedan följer hur det typiskt ser ut om man har fått en konflikt:
			</p>
			<div class="code"> 
				stalinpard@stalinpard:~/Desktop/svn_ex$ svn commit -m 'modified a.txt' <br>
				<font color="#999999">
					Sending        a.txt <br>
					svn: Commit failed (details follow): <br>
					svn: File '/trunk/a.txt' is out of date <br>
				</font>
			</div>
			<p>
				Lös detta genom att köra update (som så klart kommer klaga, men ger oss möjlighet att lösa konflikten). Nedan så löses konflikten genom att säga att filen på datorn är den som ska sparas och skriver över den i repot. Detta gör man genom att ange <code>mc</code> (förkortning för mine-conflict). Annars kan man även välja att skriva över filen på datorn med den i repot, då väljer man <code>tc</code> (förkortning för their-conflict) istället.
			</p> 
			<div class="code"> 
				stalinpard@stalinpard:~/Desktop/svn_ex$ svn update <br>
				<font color="#999999">
					Conflict discovered in 'a.txt'. <br>
					Select: (p) postpone, (df) diff-full, (e) edit, <br>
					(mc) mine-conflict, (tc) theirs-conflict, <br>
					(s) show all options: <font color="#FFFFFF">df</font> <br>
					--- .svn/text-base/a.txt.svn-base       Wed Sep  4 17:48:32 2013 <br>
					+++ .svn/tmp/a.txt.3.tmp        Wed Sep  4 18:01:18 2013 <br>
					@@ -1 +1,6 @@ <br>
					-1+1=3 <br>
					+&lt;&lt;&lt;&lt;&lt;&lt;&lt; .mine <br>
					+1+1=2 <br>
					+ <br>
					+======= <br>
					+1+2=3 <br>
					+&gt;&gt;&gt;&gt;&gt;&gt;&gt; .r7 <br>
					Select: (p) postpone, (df) diff-full, (e) edit, (r) resolved, <br>
					(mc) mine-conflict, (tc) theirs-conflict, <br>
					(s) show all options: <font color="#FFFFFF">mc</font> <br>
					G    a.txt <br>
					Updated to revision 7. <br>
				</font>
				stalinpard@stalinpard:~/Desktop/svn_ex$ svn commit -m 'modified a.txt' <br>
				<font color="#999999">
					Sending        a.txt <br>
					Transmitting file data . <br>
					Committed revision 8. <br>
				</font>
			</div>
			<p>
				Om du vill veta mer om hur man kan lösa konflikter, kan du kolla in den officiella dokumentationen <a href="http://www.tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-dug-conflicts.html">här</a>
			</p>
		</div>

		<h4>Kolla vilka filer som har ändrats</h4>
		<p>Kör kommandot <code>svn status</code>. Nedan följer ett exempel på hur det kan se ut.</p>
		<div class="code">
			stalinpard@stalinpard:~/Desktop/svn_ex$ vim a.txt <br>
			stalinpard@stalinpard:~/Desktop/svn_ex$ rm b.txt <br> 
			stalinpard@stalinpard:~/Desktop/svn_ex$ touch f.txt <br>
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn status <br>
			<font color="#999999">
				?       f.txt <br>
				M       a.txt <br>
				!       b.txt <br>
			</font>
			stalinpard@stalinpard:~/Desktop/svn_ex$
		</div>

		<h4>Visa alla filer i repot</h4>
		Kör kommandot <code>svn list *</code>
		<div class="code">
			stalinpard@stalinpard:~/Desktop/svn_ex$ svn list * <br>
			<font color="#999999">
				a.txt <br>
				c.txt <br>
				svn: 'f.txt' is not under version control
			</font>
		</div>
		<p>
			Här kan man se vilka filer som finns och även se att filen f.txt inte är versionshanterad.
		</p>

		<!--Kopierat från http://www.ida.liu.se/~TDDC76/project/SVN/-->
		<h4>Andra SVN-kommandon</h4>

		<p>
			För att se ändringshistoriken (commit-historiken):
		</p>
		<div class="code">
			svn log
		</div>
		<p>
			För att se alla ändringar sedan revision <i>rev</i>:
		</p>
		<div class="code">
			svn diff -x -wup -r <i>rev</i>
		</div>
		<p>
			Information om vad du kan göra med SVN och vilka kommandon som finns:
		</p>
		<div class="code">
			svn help
		</div>
		<p>
			Information om ett visst subkommando, <i>subkommando</i>, får du med ett
			kommando på formen:
		</p>
		<div class="code">
			svn help <I>subkommando</i>
		</div>
		<p>
			Det finns, som delvis framgått av exempel ovan, många flaggor till 
			subkommandona.
		</p>

		<h3>Mer om SVN</h3>

		<p>
			För mer information om SVN, se
		</p>
		<ul>
			<li><a href="http://en.wikipedia.org/wiki/Subversion_%28software%29">Wikipedia om Subversion</a></li>
			<li><a href="http://subversion.apache.org/">Subversions hemsida</a></li>
			<li><a href="http://svnbook.red-bean.com/">Version Control with Subversion</a> - en gratis bok om hur man sätter upp och använder Subversion</li>
		</ul>
		<!--/Kopierat från http://www.ida.liu.se/~TDDC76/project/SVN/-->

		<h3>Länktips:</h3>
		<ul>
			<li><a href="http://www.guyrutenberg.com/2007/10/29/creating-local-svn-repository-home-repository/">Gör ett eget lokalt repo</a>.</li>
			<li>Diskussion om vad Trunk, Branch, Tag är på <a href="http://stackoverflow.com/questions/16142/what-do-branch-tag-and-trunk-mean-in-subversion-repositories">stackoverflow</a>.</li>
			<li><a href="http://en.wikipedia.org/wiki/Revision_control">Wikipedia om version control</a></li>
		</ul>

	</div>
</body>

</html> 
